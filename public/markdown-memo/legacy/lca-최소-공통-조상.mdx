---
title: "LCA (ìµœì†Œ ê³µí†µ ì¡°ìƒ)"
description: ""
tags: ["Algorithm","Graph"]
date: "2023-03-09"
thumbnail: ""
---

# ê°œìš”


# ì½”ë“œ

## í¬ì†Œë°°ì—´ì„ ì‚¬ìš©í•œ LCA

> ğŸ’¡ *- íŠ¸ë¦¬ ë…¸ë“œ ìµœëŒ€ ê°œìˆ˜ê°€ ****100000****ê°œë¼ê³  ê°€ì •*


```c++
for(int i=1; i<18; i++) {
	// í¬ì†Œë°°ì—´ì„ ê³„ì‚°
	parent[i][cur] = parent[i-1][parent[i-1]][cur]];
}
```

### ì˜ˆì‹œ

`parent[2][1]` â†’ 1ë²ˆ ë…¸ë“œì—ì„œ 2^2ë§Œí¼ ìƒìœ„ ë…¸ë“œë¡œ ì´ë™í•˜ì˜€ì„ ë•Œ ë…¸ë“œ

ì¦‰, `parent[2][1]` ëŠ” `parent[1][parent[1][1]]` ë¥¼ í†µí•´ êµ¬í•  ìˆ˜ ìˆë‹¤.

1ë²ˆ ë…¸ë“œì—ì„œ **2^1ë§Œí¼ ìƒìœ„ ë…¸ë“œë¡œ ì´ë™í•˜ì˜€ì„ ë–„ì˜ ë…¸ë“œ**ì—ì„œ **2^1ë§Œí¼ ìƒìœ„ë…¸ë“œë¡œ ì´ë™**


```c++
#include <bits/stdc++.h>

using namespace std;

vector<vector<int>> edges;
int parent[18][100001];
int level[100001];

// ë…¸ë“œ Nê°œ

// O(NlogN);
void dfs(int cur, int post) {
	for(int i=1; i<18; i++) {
		// í¬ì†Œë°°ì—´ì„ ê³„ì‚°
		parent[i][cur] = parent[i-1][parent[i-1]][cur]];
	}
	for(int next : edges[cur]) {
		// ì´ì „ ë…¸ë“œë¥¼ ê¶‚ì´ ë°©ë¬¸í•  í•„ìš”ëŠ” ì—†ë‹¤.
		if(next == post) continue;
		// í•˜ìœ„ ë…¸ë“œë¡œ ì´ë™í•˜ë¯€ë¡œ ì°¨ìˆ˜ë¥¼ 1ì¦ê°€
		level[next] = level[cur] + 1;
		// ë‹¤ìŒ ë…¸ë“œì˜ ë¶€ëª¨ëŠ” í˜„ì¬ ë…¸ë“œ
		parent[0][next] = cur;
		dfs(next, cur);
	}
}

int lca(int a, int b) {
	// ì°¨ìˆ˜ëŠ” í•­ìƒ aê°€ ë†’ë„ë¡ ê³ ì •
	if(level[a] < level[b]) swap(a, b);
	// ì°¨ìˆ˜ì°¨ì´ë¥¼ ê³„ì‚°
	int diff = level[a] - level[b];
	// aì™€ bì˜ ì°¨ìˆ˜ë¥¼ ë˜‘ê°™ì´ ë§ì¶° ì¤€ë‹¤.
	for(int i=1; diff != 0; i++) {
		if(diff % 2 != 1) a = parent[i][a];
		diff /= 2;
	}
	
	int lca = a;
	
	// ë§Œì•½ ê°™ì€ ë…¸ë“œê°€ ì•„ë‹ˆë¼ë©´
	if(a != b) {
		// íŠ¸ë¦¬ ë°–ìœ¼ë¡œ ë²—ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì´ë™ í•œë‹¤
		// for(int i=0; i<18; ++i) ë„ ë¨
		// ìµœì•…ì˜ ê²½ìš° lcaì™€ì˜ ì°¨ìˆ˜ê°€ 2^17ë§Œí¼ ì°¨ì´ë‚˜ë¯€ë¡œ
		// 17ê°œì˜ ë¹„íŠ¸ë¡œ ëª¨ë“  ìˆ˜ë¥¼ í‘œí˜„ê°€ëŠ¥
		for(int i=17; i>=0; --i) {
			// íŠ¸ë¦¬ ë°–ìœ¼ë¡œ ë²—ì–´ë‚˜ì§€ ì•Šê±°ë‚˜ ë‘˜ì´ ê°™ì§€ ì•Šìœ¼ë©´ ì´ë™
			if(parent[i][a] != 0 && parent[i][a] != parent[i][b]) {
				a = parent[i][a];
				b = parent[i][b];
			}
		}
		// lca ì „ê¹Œì§€ ì´ë™í•˜ë¯€ë¡œ ë§ˆì§€ë§‰ì— ì˜¬ë ¤ì¤€ë‹¤.
		lca = parent[0][a];
	}

	return lca;
}

int main() {
	parent[0][1] = 0;
	level[1] = 1;
	dfs(1, 1);
	// 3ê³¼ 5ì˜ lca
	lca(3, 5);
}
```


# ì˜ˆì œ

[https://www.acmicpc.net/problem/12745](https://www.acmicpc.net/problem/12745)

ê¸°ë³¸ LCA + alpha. ê·¸ë˜í”„ë§Œ ê·¸ë ¤ë´ë„ ì•„ì´ë””ì–´ê°€ ë– ì˜¤ë¥¸ë‹¤.


[https://www.acmicpc.net/problem/15480](https://www.acmicpc.net/problem/15480)

  <details>
  <summary>ì½”ë“œ</summary>

</details>

ì¿¼ë¦¬ë§ˆë‹¤ ì£¼ì–´ì§€ëŠ” ì •ì  r, u, vì˜ ìƒí˜¸ê°„ì˜ lcaì˜ ê¹Šì´ì— ë”°ë¼ u, vì˜ lcaê°€ ë³€í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œë©´ ë©ë‹ˆë‹¤. 

