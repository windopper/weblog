---
title: "Fenwick"
description: ""
tags: ["Algorithm"]
date: "2024-05-25"
thumbnail: "/markdown-memo/legacy/images/cd592ca0-1b77-4199-b843-7bf9e827e6f9.png"
---

# Introduction

어떤 배열의 특정 구간 구간합과 같은 쿼리가 많을 경우 별도의 특별한 트리 구조를 만들어 이를 통해 시간복잡도 문제를 해결하기 위한 자료구조

펜윅 트리 말고도 세그먼트트리로도 문제를 해결 할 수 있으나 구현이 깔끔하고 메모리를 절약할 수 있는 장점이 있다


# Implementation

배열 A를 이용하여 세그먼트 트리를 만들면 다음과 같다

![](/markdown-memo/legacy/images/cd592ca0-1b77-4199-b843-7bf9e827e6f9.png)


위 세그먼트 트리에서 짝수 인덱스를 무시하면 아래와 같은 트리를 얻을 수 있다.

![](/markdown-memo/legacy/images/ade4b88d-7bcf-492a-80da-2a8ae4f72be0.png)


n개의 배열을 가지고 세그먼트 트리를 만들려면 2n-1개의 공간이 필요하지만 펜윅트리는 n개의 배열만 필요하다.


펜윅 트리를 구현하기위해 주어진 인덱스의 최하위 비트를 구해야 한다.

> 3 ⇒ 11
5 ⇒ 101
6 ⇒ 110
8 ⇒ 1000


최하위 비트를 구하는 과정

> i = 110

~i = 001
-i = ~i + 1
   = 001 + 1
   = 010

i & -i = 110 & 010
         = 010


## Sum

인덱스 1부터 i까지 부분 합을 구하는 연산

![](/markdown-memo/legacy/images/fbda0a82-1d6b-4e52-9aae-c08f628edbc4.png)


```python
def sum(i):
	ret = 0
	while i > 0:
		ret += tree[i]
		i -= (i & -i)
	
	return ret
```


## Add

i번쨰 배열에 값을 추가하는 연산. 이떄 i번쨰 인덱스를 포함하는 모든 노드들도 업데이트 한다

![](/markdown-memo/legacy/images/27797e73-8318-4494-a92b-db35709fee12.png)


```python
def add(i, num):
	while i <= n:
		tree[i] += num
		i += (i&-i)
```


## Point update

point update는 i번쨰 배열 값을 x만큼 증가시키는 작업을 함

```python
def update(i, x):
	add(i, x)
```


## Range Query

![](/markdown-memo/legacy/images/585737e4-c451-44cc-a685-d483734b5548.png)


인덱스 L부터 R까지 구간 합을 구하는 연산입니다.

```python
def range_query(l, r):
	return sum(r) - sum(l-1)
```


