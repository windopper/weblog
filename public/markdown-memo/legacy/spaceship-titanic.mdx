---
title: "Spaceship Titanic"
description: ""
tags: ["ML","Data Analysis"]
date: "2023-01-04"
thumbnail: "/markdown-memo/legacy/images/9773202e-6a48-43c6-8360-73e2479524f0.png"
---

[https://www.kaggle.com/competitions/spaceship-titanic](https://www.kaggle.com/competitions/spaceship-titanic)


<!-- Table of Contents -->

# Description

> *Welcome to the year 2912, where your data science skills are needed to solve a cosmic mystery. We've received a transmission from four lightyears away and things aren't looking good.*

# File and Data Field Descriptions

*PassengerId - *ìŠ¹ê°ì˜ ê³ ìœ í•œ ì•„ì´ë””

*HomePlanet - *ìŠ¹ê°ì˜ ê³ í–¥ planet

*CryoSleep - *ëƒ‰ë™ ìˆ˜ë©´ ì—¬ë¶€

*Cabin - *ìŠ¹ê°ì´ ë¨¸ë¬´ëŠ” cabin ë„˜ë²„. í˜•íƒœëŠ” deck/num/sideì´ë‹¤. sideëŠ” P (Port) ë˜ëŠ” S (Starboard) ë‘˜ ì¤‘ í•˜ë‚˜ì´ë‹¤.

*Destination *- ìŠ¹ê°ì´ ë‚´ë¦´ ì§€ì 

*Age - *ìŠ¹ê°ì˜ ë‚˜ì´

*VIP - *ìŠ¹ê°ì´ VIP ì¸ì§€?

*RoomService, FoodCourt, ShoppingMall, Spa, VRDeck - *ìŠ¹ê°ì´ í•´ë‹¹ í¸ì˜ ì‹œì„¤ì—ì„œ ì§€ë¶ˆí•œ ê°€ê²©

*Name - *ìŠ¹ê°ì˜ ì´ë¦„

*Transported - *ìŠ¹ê°ì´ ë‹¤ë¥¸ ì°¨ì›ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆëŠ”ì§€, ì—¬ê¸°ì„œëŠ” ìš°ë¦¬ê°€ ì˜ˆì¸¡í•´ì•¼ ë  ê°’ì´ë‹¤.


# Data Analysis

í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ ì„í¬íŠ¸

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
sns.set(style='darkgrid', font_scale=1.4)
import plotly.express as px
import plotly
```

```python
# import train data and test data
train = pd.reac_csv('../input/spaceship-titanic/train.csv')
test = pd.read_csv('../input/spaceship-titanic/test.csv')

# print train and test shape
print(f"Train Data Shape: {train.shape}")
print(f"Test Data Shape: {test.shape}")

Train Data Shape: (8693, 14)
Test Data Shape: (4277, 13)
```


`head()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ìŒë¶€í„° 5ê°œì˜ ë°ì´í„°ë¥¼ í™•ì¸í•´ ë³´ê² ë‹¤.

```python
train.head()
```

![](/markdown-memo/legacy/images/9773202e-6a48-43c6-8360-73e2479524f0.png)


ì „ì²´ì ì¸ ë°ì´í„° ë¶„í¬ë¥¼ í™•ì¸í•˜ê² ë‹¤.

```python
train.describe().T.sort_values(by='std', ascending=False)\
	.style.background_gradient(cmap='GnBu')\
	.bar(subset=['max'], color='#BB0000')\
	.bar(subset=['mean'], color='green')

"""
T -> ë°ì´í„°ë¥¼ ì „ì¹˜í•œë‹¤.
sort_values(by='std', ascending=False) -> 'std' í”¼ì³ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
.style.background_gradient(cmap='GnBu') -> ë°±ê·¸ë¼ìš´ë“œ ê·¸ë ˆë””ì–¸íŠ¸ë¥¼ 'GnBu' ìŠ¤íƒ€ì¼ë¡œ ì„¤ì •
.bar(subset=['max'], color='#BB0000') -> ë¶€ë¶„ì§‘í•© 'max' í”¼ì³ì— ëŒ€í•´ '#BB0000'ì˜ ìƒ‰ê¹”ì„ ì§€ì •
.bar(subset=['mean'], color='green') -> ë¶€ë¶„ì§‘í•© 'mean' í”¼ì³ì— ëŒ€í•´ 'green'ì˜ ìƒ‰ê¹”ì„ ì§€ì •
"""
```

![](/markdown-memo/legacy/images/542a7019-1b1f-4faf-af0e-d620502fb60d.png)

> ğŸ’¡ *- **`FoodCourt, VRDeck, Spa, RoomService, ShoppingMall`** í”¼ì³ë“¤ì€ ëŒ€ë¶€ë¶„ì˜ ê°’ë“¤ì´ 0ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.
- **`FoodCourt, VRDeck, Spa, RoomService, ShoppingMall`** í”¼ì³ë“¤ì€ ë§¤ìš° í° ì´ìƒì¹˜ë¥¼ ê°€ì§€ê³  ìˆë‹¤.
- count ì—´ ê°’ì´ ëª¨ë‘ ê°™ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ ë³´ì•„ ëª‡ëª‡ ê²°ì¸¡ì¹˜ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤. (ì´ëŠ” ê²°ì¸¡ì¹˜ë¥¼ íŒŒì•…í•˜ëŠ” ë¶€ë¶„ì—ì„œ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚  ê²ƒì´ë‹¤)*


ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸°ì— ì•ì„œ ë‹¤ìŒì˜ ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ê² ë‹¤.

1. **ë°ì´í„° ê²°ì¸¡ê°’ ë° ì¤‘ë³µ ì—¬ë¶€ í™•ì¸í•˜ê¸°**
1. **ë°ì´í„° ì¹´ë””ë„ë¦¬í‹°(cardinality) í™•ì¸**
1. **ë°ì´í„° í”¼ì³ íƒ€ì… í™•ì¸**
1. **íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ ì§„í–‰**

# ë°ì´í„° ê²°ì¸¡ê°’ ë° ì¤‘ë³µ ì—¬ë¶€ í™•ì¸í•˜ê¸°

ë°ì´í„°ì—ì„œ ê²°ì¸¡ê°’ì„ ì°¾ëŠ” ë°©ë²•ì€ ê°„ë‹¨í•˜ë‹¤.

`DataFrame` ê°ì²´ì˜ `isna()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ í”¼ì³ë“¤ì´ ê²°ì¸¡ê°’ì¸ì§€ ì•„ë‹Œì§€ ë¶ˆë¦¬ì–¸(Boolean) í˜•íƒœë¡œ ë³€í™˜í•˜ê³ , `True` ê°’ì´ ìˆ«ìë¡œ `1` ì¸ ì ì„ ì‚¬ìš©í•˜ì—¬ `sum()` ë©”ì„œë“œë¥¼ í†µí•´ ê° í”¼ì³ë³„ ê²°ì¸¡ê°’ì˜ ê°œìˆ˜ë¥¼ êµ¬í•œë‹¤.

```python
print(train.isna().sum())

PassengerId       0
HomePlanet      201
CryoSleep       217
Cabin           199
Destination     182
Age             179
VIP             203
RoomService     181
FoodCourt       183
ShoppingMall    208
Spa             183
VRDeck          188
Name            200
Transported       0
dtype: int64
```

*PassengerId*ë¥¼ ì œì™¸í•œ ëª¨ë“  í”¼ì³ë“¤ì´ ê²°ì¸¡ê°’ì„ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

ê²°ì¸¡ê°’ ì‹œê°í™” í•˜ê¸°

```python
train_null = pd.DataFrame(train.isna().sum(), columns=['Null Count'])
test_null = pd.DataFrame(test.isna().sum(), columns=['Null Count'])
fig = plotly._subplots.make_subplots(1, 2)
fig.add_trace(plotly.graph_objects.Bar(x=train_null['Null Count'], y=train_null.index,
                                      orientation='h',
                                      ), 1 ,1)
fig.add_trace(plotly.graph_objects.Bar(x=test_null['Null Count'], y=test_null.index,
                                      orientation='h',), 1 ,2)
fig.update_layout(showlegend=False, title_text='Missing Values', title_x=0.5)
fig.show()
```


![](/markdown-memo/legacy/images/68d0dc7c-e9bd-4036-91f7-fe1cd5bf5b00.png)

> ğŸ’¡ - ê³ ë¥´ê²Œ ê²°ì¸¡ì¹˜ê°€ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ ëª‡ëª‡ í”¼ì³ë“¤ì„ íŠ¹ì •ê°’ìœ¼ë¡œ ì±„ìš¸ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.
- í”¼ì³ `PassengerId`ëŠ” ê²°ì¸¡ì¹˜ê°€ ë‚˜íƒ€ë‚˜ì§€ ì•Šì•˜ë‹¤.

# ë°ì´í„° ì¹´ë””ë„ë¦¬í‹° í™•ì¸

`DataFrame`ê°ì²´ì˜ `nunique()` ë©”ì„œë“œëŠ” ìœ ë‹ˆí¬í•œ ê°’ì— ëŒ€í•œ ê°œìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.

```python
print(train.nunique())

PassengerId     8693
HomePlanet         3
CryoSleep          2
Cabin           6560
Destination        3
Age               80
VIP                2
RoomService     1273
FoodCourt       1507
ShoppingMall    1115
Spa             1327
VRDeck          1306
Name            8473
Transported        2
dtype: int64
```

```python
# ë°ì´í„°ì˜ ìœ ë‹ˆí¬í•œ ê°’ì˜ ê°œìˆ˜ë¥¼ ì‹œê°í™” í•¨
train_nunique = pd.DataFrame(train.nunique(), columns=['nunique'])
# í›ˆë ¨ ë°ì´í„°ì˜ ìœ ë‹ˆí¬í•œ ê°’ì˜ ê°œìˆ˜ë¥¼ ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë§Œë“¤ê³ 
# ê·¸ ê°œìˆ˜ì˜ ë¼ë²¨ì„ 'nunique' ë¼ê³  ëª…ëª…
fig = px.bar(train_nunique, y='nunique', color='nunique', orientation='v', text_auto=True
      ,color_continuous_scale='armyrose',)
# ë°” í˜•íƒœì˜ ê·¸ë˜í”„ë¥¼ ë§Œë“  í›„, yì¶•ì˜ ê°’ì„ 'nunique'ë¡œ ì„¤ì •.
# ìˆ˜ì¹˜ ê°’ì„ ê·¸ë˜í”½ìœ¼ë¡œ ì˜¬ë¦° í›„, ì—°ì† ìŠ¤ì¼€ì¼ ì»¬ëŸ¬ëŠ” 'armyrose'ë¡œ ì„¤ì •
fig.update_layout(showlegend=False)
```

![](/markdown-memo/legacy/images/1e1bcafd-39a8-4409-9f7b-87d4808084b4.png)

ì¹´ë””ë„ë¦¬í‹°ë¥¼ í™•ì¸í•˜ì—¬ ì¤‘ë³µë„ê°€ ì ì€ ë°ì´í„°ì™€ ë§ì€ ë°ì´í„°ë¡œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.

- ì ì€ ì¤‘ë³µë„ë¥¼ ê°€ì§„ ë°ì´í„°
- í° ì¤‘ë³µë„ë¥¼ ê°€ì§„ ë°ì´í„°
# ë°ì´í„° í”¼ì³ íƒ€ì… í™•ì¸

```python
print(train.dtypes)

PassengerId      object
HomePlanet       object
CryoSleep        object
Cabin            object
Destination      object
Age             float64
VIP              object
RoomService     float64
FoodCourt       float64
ShoppingMall    float64
Spa             float64
VRDeck          float64
Name             object
Transported        bool
dtype: object
```


# íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ ì§„í–‰

ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸°ì— ì•ì„œ ì¹´ë””ë„ë¦¬í‹° ë¶„ì„ìœ¼ë¡œ í™•ì¸í–ˆë˜ ë°ì´í„°ì— ë”°ë¼ì„œ ë‘ ë¶„ë¥˜ë¡œ ë‚˜ëˆ„ì—ˆë‹¤.

```python
categories = ['HomePlanet', 'CryoSleep', 'Destination', 'VIP']
numericals = ['Age', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck']
"""
ìš°ë¦¬ê°€ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ê°’ì€ 'Transported' ì´ë‹¤.
"""
```

```python
for category in categories:
	px.histogram(train.dropna(), x='Transported', facet_col=category, color='Transported').show()
```


![](/markdown-memo/legacy/images/2bb5579b-8e3c-4386-8f0c-c13d83b42bfb.png)

![](/markdown-memo/legacy/images/47390799-8929-4cac-ba82-30a9834114c9.png)

![](/markdown-memo/legacy/images/6bdd035c-3c76-458c-8a47-4e742731e5f3.png)

![](/markdown-memo/legacy/images/956a45a0-2085-44c3-90ce-030cbf2c26ee.png)


```python
for numerical in numericals:
    px.histogram(train.dropna(), x=numerical, color='Transported', marginal='box').show()
```


![](/markdown-memo/legacy/images/1e28d464-acf1-48f3-8cbe-55eb388c9d33.png)

![](/markdown-memo/legacy/images/1b1a25f9-5281-4988-91c9-218fb0eff040.png)

![](/markdown-memo/legacy/images/5cf41edd-ac56-4a2b-9f0e-45058a6de87f.png)

![](/markdown-memo/legacy/images/f4e0cc88-ec94-4136-997f-6bee8085de25.png)

![](/markdown-memo/legacy/images/e2a0a05e-12c2-464e-a6d3-369ece8859c6.png)

![](/markdown-memo/legacy/images/d2f12a54-0ed3-42d8-bc3d-62cf9e7310b3.png)

> ğŸ’¡ - *Europaê°€ ê³ í–¥ì¸ ì‚¬ëŒë“¤ì´ ìƒëŒ€ì ìœ¼ë¡œ ë” ë§ì´ Transported ë˜ì—ˆê³ , Earthê°€ ê³ í–¥ì¸ ì‚¬ëŒë“¤ì€ ìƒëŒ€ì ìœ¼ë¡œ ë” ì ê²Œ Transported ë˜ì—ˆë‹¤.
- ë™ë©´ì— ë“¤ì§€ ì•Šì€ ì‚¬ëŒë“¤ì€ Transported ë  í™•ë¥ ì´ ì ì—ˆê³ , ë™ë©´ì— ë“  ì‚¬ëŒë“¤ì€ Transported ë  í™•ë¥ ì´ ë†’ì•˜ë‹¤.
- Transported ë˜ëŠ” ê¸°ì¤€ì€ ë‚˜ì´ì— ê±°ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šì•˜ë‹¤.
- ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒë“¤ì€ RoomService, FoodCourt, ShoppingMall, Spa, VRDeck ê°™ì€ ê³ ê¸‰ í¸ì˜ ì‹œì„¤ì„ ì´ìš©í•˜ì§€ ì•Šì•˜ë‹¤.*


# ì¶”ê°€ì ì¸ ë°ì´í„° ë¶„ì„

## Q1. ê³ ê¸‰ í¸ì˜ ì‹œì„¤ì— ëˆì„ ë§ì´ ì“´ ì‚¬ëŒë“¤ì€ ëŒ€ë¶€ë¶„ VIP ì¼ê¹Œ?

ë¨¼ì €, ê³ ê¸‰ í¸ì˜ ì‹œì„¤ì¸ `RoomService, FoodCourt, ShoppingMall, Spa, VRDeck` ë¥¼ ëª¨ë‘ í•©ì¹œ ê°’ê³¼ `VIP` í”¼ì³ë¥¼ ë”°ë¡œ ì¶”ì¶œí•œ í›„ ìƒˆë¡œìš´ `DataFrame` ê°ì²´ë¥¼ ë§Œë“¤ì—ˆë‹¤.

```python
train_sums = pd.DataFrame(train.dropna()[['VRDeck', 'RoomService', 'FoodCourt',
	'ShoppingMall', 'Spa']].sum(axis=1), columns=['luxury_sum'])
train_sums = pd.concat([train_sums, train.dropna()['VIP']], axis=1)
```

```python
px.histogram(train_sums, x='VIP', color='VIP')
```


![VIP íšŒì›ì˜ ìˆ˜](/markdown-memo/legacy/images/0c002fce-01b0-4ac1-a6b3-ebc38f8c3809.png)

VIP íšŒì›ì˜ ìˆ˜ëŠ” ê°ê° 6444ëª…ê³¼ 162ëª…ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë‹¤.

```python
px.histogram(train_sums, x='luxury_sum', color='VIP', marginal='box')
```

![](/markdown-memo/legacy/images/f9a39bf1-6552-4890-bfef-6e8b07f016ec.png)

> ğŸ’¡ *- VIPë“¤ ì¤‘ ê³ ê¸‰ í¸ì˜ ì‹œì„¤ì— ì“´ ëˆì˜ ì¤‘ì•™ê°’ì€ ****2776.5k**** ë¡œ VIPê°€ ì•„ë‹Œ ì‚¬ëŒë“¤ ì¤‘ ì“´ ëˆì˜ ì¤‘ì•™ê°’ì¸ ****724k ****ë³´ë‹¤ ë†’ì€ ê²ƒìœ¼ë¡œ íŒŒì•…ë˜ì—ˆë‹¤.*


## Q2. ê°™ì€ ê·¸ë£¹ì— ì†í•œ ì‚¬ëŒë“¤ì€ ë™ë©´ ì—¬ë¶€ì— ëŒ€í•´ ë™ì¼í•œ ì„ íƒì„ í–ˆì„ê¹Œ?

í•´ë‹¹ ë°ì´í„°ì—ì„œëŠ” `PassengerId`ê°€ `gggg_pp`ì˜ í˜•íƒœë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ë§í•˜ê³  ìˆë‹¤. ì—¬ê¸°ì„œ `gggg`ëŠ” ê·¸ë£¹ì„ ê°€ë¦¬í‚¤ë©° `pp`ëŠ” í•´ë‹¹ ê·¸ë£¹ ë‚´ì˜ ë²ˆí˜¸ë¼ê³  ë§í•œë‹¤.

ë˜í•œ ì£¼ë¡œ ê·¸ë£¹ì— ì†í•œ ì‚¬ëŒë“¤ì€ ëŒ€ë¶€ë¶„ ê°€ì¡± êµ¬ì„±ì›ì´ë¼ê³  ë§í•˜ë©° ëª¨ë“  ê·¸ë£¹ êµ¬ì„±ì›ë“¤ì´ ëª¨ë‘ ê·¸ë ‡ì§€ëŠ” ì•Šë‹¤ê³  í•œë‹¤.


***ê·¸ë ‡ë‹¤ë©´ íƒ‘ìŠ¹ê° ê·¸ë£¹ ì¤‘ ëª¨ë‘ ê°™ì€ ë™ë©´ ì—¬ë¶€ë¥¼ ì„ íƒí•˜ì§€ ì•Šì€ ê·¸ë£¹ì€ ì–¼ë§ˆë‚˜ ë ê¹Œ?***


ì´ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ë¨¼ì € ê°™ì€ ê·¸ë£¹ì„ì„ ëœ»í•˜ëŠ” `PassengerId`ì˜ `gggg_pp` í˜•íƒœì—ì„œ `gggg` ë§Œ ì¶”ì¶œí•œ í›„, ë™ë©´ ì—¬ë¶€ë¥¼ ëœ»í•˜ëŠ” `CryoSleep` í”¼ì³ë¥¼ ê°€ì ¸ì˜¤ê² ë‹¤.

```python
group = train.PassengerId.str.split('_').str[0].to_frame('Group')
group = pd.concat([group, train['CryoSleep']], axis=1)
```

`train` ì—ì„œ `split()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `gggg` ì™€ `pp` ë¡œ ìª¼ê°  í›„ `gggg` ìš”ì†Œë§Œ ê°€ì ¸ì™€ì„œ í”¼ì³ ì´ë¦„ì„ `Group` ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ë‹¤.

`pandas` ëª¨ë“ˆì˜ `concat` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `group` ê³¼ `train['CryoSleep']` ë¥¼ í•©ì¹œë‹¤. íŒŒë¼ë¯¸í„° `axis=1` ì€ `row-wise` í•˜ê²Œ í•©ì¹˜ê² ë‹¤ëŠ” ëœ»ì´ë‹¤.


í•„ìš”í•œ ë°ì´í„°ë¥¼ ê·¸ë£¹í™” í•œ í›„ ê°™ì€ ê·¸ë£¹ì˜ ì¸ì›ë“¤ ì¤‘ ë™ë©´ì— ë“  ì‚¬ëŒì´ ìˆëŠ”ì§€ ê·¸ë¦¬ê³  ê·¸ë£¹ì›ì˜ ìˆ˜ëŠ” ëª‡ ëª… ì¸ì§€ë¥¼ ê³„ì‚°í•˜ëŠ” í”¼ì³ë¥¼ ë§Œë“¤ì–´ ì¶”ê°€í•˜ê² ë‹¤.

í”¼ì³ ì´ë¦„ì€ ê°ê° `IsGroupCryoSleep`ê³¼ `GroupCount` ë¼ê³  ëª…ëª…í–ˆë‹¤.

```python
group['IsGroupCryoSleep'] = False
group['GroupCount'] = 0
```


`Group`ì— ëŒ€í•˜ì—¬ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œ í›„ ìƒìœ„ 10ê°œë¥¼ ì¶œë ¥í•´ë³´ê² ë‹¤.

<!-- Unknown block type: column_list -->

```python
print(group.isna().sum())

Group                 0
CryoSleep           217
IsGroupCryoSleep      0
GroupCount            0
dtype: int64


len_group = len(group) # rowë¥¼ ë“œë¡­í•˜ê¸° ì „ ê¸¸ì´ë¥¼ ì €ì¥í•œë‹¤!
group = group.dropna(axis=0)
```

ê²°ì¸¡ê°’ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì `CryoSleep` í”¼ì³ ê°’ì— 217ê°œê°€ í™•ì¸ë˜ì—ˆë‹¤. í•´ë‹¹ ê°’ë“¤ì€ True ë˜ëŠ” Falseë¡œ ì„ì˜ë¡œ ì„¤ì •í•˜ê¸° ì• ë§¤í•˜ë¯€ë¡œ í•´ë‹¹ í”¼ì³ë¥¼ ê°€ì§„ í–‰ì„ ë“œëí•˜ì˜€ë‹¤.


ì´ì œ ê·¸ë£¹í™”í•œ ë°ì´í„°ë¥¼ ëŒë©´ì„œ `IsGroupCryoSleep` ê³¼ `GroupCount` ì˜ ì—¬ë¶€ë¥¼ ê³„ì‚°í•´ì•¼ í•œë‹¤.

```python
mem_index = [] #
current_group = 1
is_group_cryo_sleep = False

for i in range(len_group): # ëª¨ë“  ë°ì´í„°ì— ëŒ€í•˜ì—¬ ë£¨í”„ë¥¼ ëˆë‹¤.
		if not group.index.isin([i]).any(): continue
		# 217ê°œì˜ rowë¥¼ ë“œëí•˜ì˜€ìœ¼ë¯€ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼í•  ìˆ˜ë„ ìˆë‹¤.
		# try-catch ë¬¸ìœ¼ë¡œ ê°ìŒ€ ìˆ˜ë„ ìˆì—ˆìœ¼ë‚˜ if ë¬¸ìœ¼ë¡œ ê°€ë³ê²Œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê¸°ì—
		# ì¡´ì¬ ì—¬ë¶€ë§Œ í™•ì¸ í•œ í›„ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ continueë¥¼ í†µí•˜ì—¬ ë‹¤ìŒ ì´í„°ë ˆì´ì…˜ì„ ì§„í–‰í•˜ì˜€ë‹¤.

    if current_group is not int(group.loc[i, 'Group']): 
				# í˜„ì¬ ê·¸ë£¹ì´ í•´ë‹¹ ì¸ë±ìŠ¤ì˜ ê·¸ë£¹ì´ ì•„ë‹ ë•Œ
        for j in mem_index:
            group.loc[j, 'IsGroupCryoSleep'] = is_group_cryo_sleep
						# ê°™ì€ ê·¸ë£¹ì´ ë™ë©´ì— ë“¤ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì €ì¥í•œë‹¤.
            group.loc[j, 'GroupCount'] = len(mem_index)
						# ê·¸ë£¹ ìˆ˜ëŠ” ëª‡ ëª…ì¸ì§€ ê°’ì„ ì €ì¥í•œë‹¤.

        current_group = int(group.loc[i, 'Group'])
        mem_index = []
        is_group_cryo_sleep = False
				# ë‹¤ë¥¸ ê·¸ë£¹ìœ¼ë¡œ ë„˜ì–´ê°ˆ ë•Œ ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™” í•´ì¤€ë‹¤.
        
    mem_index.append(i)
		# ê°™ì€ ê·¸ë£¹ ì‚¬ëŒë“¤ì¸ ìš”ì†Œì˜ ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•œë‹¤.
    if not is_group_cryo_sleep and group.loc[i, 'CryoSleep']:
				# ê°™ì€ ê·¸ë£¹ì´ ë™ë©´ì„ í•˜ì§€ ì•Šê³  í˜„ì¬ ì¸ë±ìŠ¤ì˜ ë™ë©´ ì—¬ë¶€ê°€ True ì¼ê²½ìš°
        is_group_cryo_sleep = True # ê·¸ë£¹ì˜ ë™ë©´ ì—¬ë¶€ë¥¼ Trueë¡œ ì„¤ì •í•œë‹¤.

# ë§ˆì§€ë§‰ ê·¸ë£¹ì— ëŒ€í•´ì„œëŠ” ìƒë‹¨ì˜ for loopì—ì„œ ë™ë©´ì—¬ë¶€ì™€ ê·¸ë£¹ ìˆ˜ê°€ ì €ì¥ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ
# mem_indexì— ëŒ€í•´ ì €ì¥ëœ ì¸ë±ìŠ¤ë“¤ì— ëŒ€í•´ì„œ ê°’ì„ ì„¤ì •í•´ì¤€ë‹¤.
for j in mem_index:
    group.loc[j, 'IsGroupCryoSleep'] = is_cryo_sleep
    group.loc[j, 'GroupCount'] = len(mem_index)
```


ì „ì²´ ê·¸ë£¹ì— ëŒ€í•´ ê·¸ë£¹ì› ì¤‘ í•œ ëª…ì´ë¼ë„ ë™ë©´ì„ ì„ íƒí•œ ê·¸ë£¹ì˜ ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
px.bar(group.groupby('Group').any().groupby('IsGroupCryoSleep').count(), y='CryoSleep')
```

![](/markdown-memo/legacy/images/680b3740-5620-4c79-8d9f-645f5fc2de43.png)

ì „ì²´ ê·¸ë£¹ì— ëŒ€í•˜ì—¬ ê·¸ë£¹ì› í•œ ëª…ì´ë¼ë„ ë™ë©´ì„ ì„ íƒí•œ ê²½ìš°ëŠ” **2483**ê±´, ì•„ë‹Œ ê²½ìš°ëŠ” **3626**ê±´ìœ¼ë¡œ ì§‘ê³„ë˜ì—ˆë‹¤.

ê·¸ë£¹ì› í•œ ëª…ì´ë¼ë„ ë™ë©´ì„ ì„ íƒí•œ **2483ê±´**ì¤‘ ë™ë©´ì„ ì„ íƒí•˜ì§€ ì•Šì€ ê·¸ë£¹ì›ì´ ìˆëŠ” ê·¸ë£¹ì˜ ìˆ˜ë¥¼ ê³„ì‚°í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
len(group[(group['CryoSleep'] == False) & (group['IsGroupCryoSleep'] == True)]
	.groupby('Group'))

811
```

í”¼ì³ `CryoSleep`ì´ `False` ì´ê³  `IsGroupCryoSleep` ì´ `True` ì¸ ë°ì´í„°ë“¤ì„ `Group` ìœ¼ë¡œ ë¬¶ì–´ì„œ ê°œìˆ˜ë¥¼ ê³„ì‚°í•˜ë©´ **811**ê±´ì´ ë„ì¶œëœë‹¤.


> ğŸ’¡ *- ë™ë©´ì„ ê²°ì •í•œ ê·¸ë£¹ì›ì´ ìˆëŠ” ê·¸ë£¹ ****2483ê±´**** ì¤‘ ****811ê±´****ì´ ë™ë©´ì„ ê²°ì •í•˜ì§€ ì•Šì€ ê·¸ë£¹ì›ì´ ì¡´ì¬í•œë‹¤. ì´ëŠ” ì•½ ****32.6%****ì— ì†í•œë‹¤.*


ë°ì´í„° ìƒê´€ê´€ê³„ íŒŒì•…í•˜ê¸°

```python
sns.heatmap(train.corr()[['Transported']], annot=True)
```

![](/markdown-memo/legacy/images/25daa356-0c73-4e59-bab5-e244e2c67396.png)


# ê²°ì¸¡ê°’ ì²˜ë¦¬í•˜ê¸°

EDA (Exploratory Data Analysis)ë¥¼ í†µí•´ì„œ í™•ì¸ í•  ìˆ˜ ìˆì—ˆë“¯ì´ ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒë“¤ì€ Luxury Amenities ë¥¼ ì´ìš©í•˜ì§€ ì•Šì•˜ë‹¤. ë˜í•œ `Age, RoomService, FoodCourt` ë“±ì˜ numericalí•œ í”¼ì³ë“¤ì€ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ê°’ì¸ `Transported` ì™€ ìƒê´€ê´€ê³„ê°€ ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ëª¨ë‘ ì¤‘ì•™ê°’ì„ ë„£ë„ë¡ í•˜ê² ë‹¤.

```python
from sklearn.impute import SimpleImputer
impute_cols = ['Age', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck']
imputer = SimpleImputer(strategy='median') # strategy íŒŒë¼ë¯¸í„°ë¥¼ ì¤‘ì•™ê°’ìœ¼ë¡œ ì„¤ì •!!
imputer.fit(train[impute_cols])
train[imputer_cols] = imputer.transform(train[imputer_cols])
test[imputer_cols] = imputer.transform(test[imputer_cols])
```


í”¼ì³ `PassengerId, Name, Cabin`ì€ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¬ ë•Œ ì œì™¸í•˜ë„ë¡ í•˜ê² ë‹¤.

```python
drop_columns = ['PassengerId', 'Name', 'Cabin']
train = train.drop(columns=drop_columns)
test = test.drop(columns=drop_columns)
```


ë‚˜ë¨¸ì§€ í”¼ì³ë“¤ì€ row-wise ë¡œ ë“œëì‹œì¼œ ëª¨ë“  ê²°ì¸¡ê°’ì„ ì—†ì• ë„ë¡ í•˜ê² ë‹¤.

```python
train = train.dropna(axis=0)
test = test.dropna(axis=0)
```


# ë°ì´í„° ì „ì²˜ë¦¬

ë²”ì£¼í˜• í”¼ì³ëŠ” ì›-í•« ì¸ì½”ë”©ì„ ì§„í–‰í•˜ê³  ìˆ˜ì¹˜í˜• í”¼ì³ë“¤ì€ í‘œì¤€ì •ê·œí™”ë¥¼ ì§„í–‰í•˜ë„ë¡ í•˜ê² ë‹¤.

ë˜í•œ `train` ë°ì´í„° ì…‹ì˜ `Transported` í”¼ì³ëŠ” `Boolean` í˜•íƒœë¥¼ ìˆ«ìë¡œ ë°”ê¿”ì£¼ë„ë¡ í•˜ê² ë‹¤. 

```python
train = pd.get_dummies(train, columns=categories)
test = pd.get_dummeis(test, columns=categories)

from sklearn.preprocessing import StandardScaler
scale_target = ['Age', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck']
scaler = StandardScaler()
scaler.fit(train[scale_target])
train[scale_target] = scaler.transform(train[scale_target])
test[scale_target] = scaler.transform(test[scale_target])

train.loc[train['Transported'] == True, 'Transported'] = 1
train.loc[train['Transported'] == False, 'Transported'] = 0
```


í›ˆë ¨í•˜ê¸°ì— ì•ì„œ ì…ë ¥ ë°ì´í„°ì™€ ì¶œë ¥ ë°ì´í„°ë¡œ ë¶„ë¦¬í•´ ì¤˜ì•¼ í•˜ëŠ”ë° í•´ë‹¹ íƒœìŠ¤í¬ì—ì„œëŠ” `Transported` í”¼ì³ê°€ íƒ€ê²Ÿ ë°ì´í„° ì´ë¯€ë¡œ í•´ë‹¹ ì½”ë“œë¡œ íƒ€ê²Ÿì„ ë¶„ë¦¬í•´ì¤€ë‹¤.

```python
X = train.drop(columns=['Transported'])
y = train['Transported']
```


`sklearn.model_selection` ì˜ `train_test_split` ìœ¼ë¡œ í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„°ë¡œ ë¶„ë¦¬í•˜ì—¬ ì¤€ë‹¤.

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=123)

X_train.shape
(6330, 16)
y_train.shape
(6330, )
X_test.shape
(1583, 16)
y_test.shape
(1583, )
```

ë°ì´í„°ê°€ ì˜ ë¶„ë¦¬ë˜ì—ˆë‹¤.


# ëª¨ë¸ í›ˆë ¨ì‹œí‚¤ê¸°

ìºê¸€ì˜ ì°¸ê°€ìë“¤ì´ ì• ìš©í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì¸ XGBoostë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ì§„ ë¶„ë¥˜ë¥¼ ì‹œí–‰í•˜ê² ë‹¤.

```python
import xgboost as xgb
xgb_clf = xgb.XGBClassifier()
xgb_clf.fit(X_train, y_train)
y_pred = xgb_clf.predict(X_test)
```


# ëª¨ë¸ í‰ê°€í•˜ê¸°

```python
from sklearn.metrics import accuracy_score, classification_report

print(accuracy_score(y_test.tolist(), y_pred))
print(classification_report(y_test.tolist(), y_pred))

0.784586228679722

								precision    recall  f1-score   support

           0       0.80      0.76      0.78       793
           1       0.77      0.81      0.79       790

    accuracy                           0.78      1583
   macro avg       0.79      0.78      0.78      1583
weighted avg       0.79      0.78      0.78      1583
```

ì•½ **78.4%**ì˜ ì •í™•ë„ë¥¼ ë³´ì¸ë‹¤


